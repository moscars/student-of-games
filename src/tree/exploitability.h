#pragma once

#include "../utils/publicBeliefState.h"
#include "../utils/utils.h"
#include "../game/equity.h"
#include "../settings.h"
#include <torch/torch.h>

#include <memory>
#include <cassert>

class Exploitability{

public:
    Exploitability() = default;

    void compute(std::shared_ptr<PublicBeliefState> tree);
private:
    void fillRanges(std::shared_ptr<PublicBeliefState> node, torch::Tensor ranges_absolute);
    void computeInternal(std::shared_ptr<PublicBeliefState> node);

};